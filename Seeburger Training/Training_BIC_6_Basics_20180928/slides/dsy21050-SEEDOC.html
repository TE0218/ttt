<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:p="http://outerx.org/daisy/1.0#publisher" xmlns:i18n="http://apache.org/cocoon/i18n/2.1" xmlns:einclude="http://outerx.org/daisy/1.0#externalinclude" xmlns:d="http://outerx.org/daisy/1.0">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="resources/css/books.css" type="text/css" rel="stylesheet">
<script src="resources/js/toggle.js" type="text/javascript"></script>
</head>
<body onLoad="appendToDiv();">
<div class="all">
<div class="top">
<div class="chunkNavigation">
<div class="topCut"></div>
<div class="logoTitle">
<span><img src="resources/images/see-logo.png"></span><span class="bookTitle">Mapfile and MapDB Handling</span>
</div>
<div class="navigation">
<ul>
<li class="first">
<a href="dsy20887-SEEDOC.html">&nbsp;<img src="resources/images/small_left.gif">&nbsp;Previous&nbsp;</a>
</li>
<li class="middle">
<a href="chunk1.html"><img src="resources/images/content.png">Table of Contents&nbsp;</a>
</li>
<li class="last">
<a href="dsy21051-SEEDOC.html">&nbsp;Next&nbsp;<img src="resources/images/small_right.gif"></a>
</li>
</ul>
</div>
</div>
</div>
<div class="content">
<div class="left">
<a href="dsy20887-SEEDOC.html"><img src="resources/images/big_left.gif" class="centeredImage"></a>
</div>
<div class="center">
<h3 xmlns:ns="http://outerx.org/daisy/1.0" daisyBranch="1" daisyDocument="21050-SEEDOC" daisyLanguage="2" id="dsy21050-SEEDOC">How to use a MapDB - openMapDB</h3>
        
<p>Opens a database access for mapDB commands.</p>
        
<ul>
            
<li>openMapDB(name,connection,table,sourceField,destinationField,defaultValue)
</li>
        
</ul>
        
<pre>openMapDB("Country_Name","DB","COUNTRY_TO_CURRENCY","COUNTRY_CODE","COUNTRY_NAME","");
openMapDB("Country_Curreny","DB","COUNTRY_TO_CURRENCY","COUNTRY_CODE","COUNRTY_CURRENCY","");
openMapDB("Country_Continent","DB","COUNTRY_TO_CURRENCY","COUNTRY_CODE","COUNTRY_CONTINENT","");</pre>
        
<h8 id="s138">For more details please refer to</h8>
        
<h8 daisyBranch="1" daisyDocument="2298-SEEDOC" daisyLanguage="2" id="dsy2298-SEEDOC">MapDB Commands</h8>
        
<p>MapDB commands provide a comfortable access on mapDB tables. They are data
base lookup commands especially tailored to read and to modify records found
through a key value.</p>
        
<p>The term <em>source</em> is used in this context for the column in which it
is search for the key value. For a found record the value from another column,
the <em>destination</em> (column) is returned.</p>
        
<p>The following commands are available:</p>
        
<ul>
            
<li>
                
<em>
                    <a href="dsy20887-SEEDOC.html#dsy2818-SEEDOC">
                        <p:linkInfo access="read,fullRead,write,publish,delete" documentName="connectDB" documentType="SimpleDocument" href="daisy:2818-SEEDOC" lastVersionId="17" liveVersionId="17">
                            <p:linkPartInfo id="7" mimeType="text/xml" name="SimpleDocumentContent" size="3801"/>
                        </p:linkInfo>connectDB</a>
                </em>&nbsp;
(Connect databases)</li>
            
<li>
                
<a href="dsy20886-SEEDOC.html#dsy2944-SEEDOC">
                    <p:linkInfo access="read,fullRead,write,publish,delete" documentName="openMapDB" documentType="SimpleDocument" href="daisy:2944-SEEDOC" lastVersionId="21" liveVersionId="21">
                        <p:linkPartInfo id="7" mimeType="text/xml" name="SimpleDocumentContent" size="2940"/>
                    </p:linkInfo>
                    <em>openMapDB</em>&nbsp;</a> (<em>init</em> a
<em>mapdb</em> lookup)</li>
            
<li>
                
<em>mapDB</em> (map the <em>keyfield
</em>to the <em>valueField</em>, and return the found value)</li>
            
<li>
                
<em>writeToMapDB</em> (create new record in
the table)</li>
            
<li>
                
<em>updateToMapDB</em> (update an existing
record)</li>
            
<li>
                
<em>deleteFromMapDB</em> (delete a record
from the table).</li>
        
</ul>
        
<h9 id="s139">openMapDB / mapDB</h9>
        
<pre>openMapDB(&lt;name&gt;, &lt;connection's name or DSN&gt;, &lt;table&gt;, &lt;source field&gt;, &lt;destination field&gt;, &lt;default value&gt;);</pre>
        
<table column-widths="30%;70%" print-column-widths="30%;70%" print-width="100%" width="100%" class="content">
<col width="30%">
<col width="70%">
<tbody>
                
<tr>
                    
<th>
                        
<p>Parameter</p>
                    
</th>
                    <th>
                        
<p>Description</p>
                    
</th>
                
</tr>
                
<tr>
                    
<td valign="top">
                        
<p>Name</p>
                    
</td>
                    <td valign="top">
                        
<p>Name to identify this map table.</p>
                    
</td>
                
</tr>
                
<tr>
                    
<td valign="top">
                        
<p>Connection name</p>
                    
</td>
                    <td valign="top">
                        
<p>Applied database connection.</p>
                    
</td>
                
</tr>
                
<tr>
                    
<td valign="top">
                        
<p>Table</p>
                    
</td>
                    <td valign="top">
                        
<p>Name of the mapping code table.</p>
                    
</td>
                
</tr>
                
<tr>
                    
<td valign="top">
                        
<p>Source field, destination field, default value</p>
                    
</td>
                    <td valign="top">
                        
<p>For the <em>source field</em> as search index, the <em>destination field</em>
will&nbsp; be returned.<br>
If the source value cannot be found in the table, the default value will be
returned.</p>
                    
</td>
                
</tr>
            
</tbody>
</table>
        
<pre>mapDB(&lt;name&gt;, &lt;key value&gt;);</pre>
        
<table column-widths="30%;70%" print-column-widths="30%;70%" print-width="100%" width="100%" class="content">
<col width="30%">
<col width="70%">
<tbody>
                
<tr>
                    
<th>
                        
<p>Parameter</p>
                    
</th>
                    <th>
                        
<p>Description</p>
                    
</th>
                
</tr>
                
<tr>
                    
<td valign="top">
                        
<p>Name</p>
                    
</td>
                    <td valign="top">
                        
<p>Name of the corresponding map table.</p>
                    
</td>
                
</tr>
                
<tr>
                    
<td valign="top">
                        
<p>key value</p>
                    
</td>
                    <td valign="top">
                        
<p>The value of the key field (used to identify the correct record).</p>
                    
</td>
                
</tr>
            
</tbody>
</table>
        
<p>This function will return the mapped value, i. e., find the record which
matches <em>source field= value</em> and return the <em>destination value</em>.
</p>
        
<h10 id="s140">Write (Create),&nbsp; Update, Delete Commands</h10>
        
<p>There also are three commands that can be used for updating a code mapping
table:</p>
        
<ul>
            
<li></li>
            
<li>
                
<em>updateToMapDB</em>
            
</li>
            
<li>
                
<em>deleteFromMapDB</em>
            
</li>
        
</ul>
        
<p>
            
<em></em>(&lt;<em>lookupname</em>&gt;,
&lt;<em>sourcefieldvalue</em>&gt;, &lt;<em>destinationfieldvalue</em>&gt;). Adds
a new record to the table with the given source field value in the defined
source field of the <em>
                <a href="dsy20886-SEEDOC.html#dsy2944-SEEDOC">
                    <p:linkInfo access="read,fullRead,write,publish,delete" documentName="openMapDB" documentType="SimpleDocument" href="daisy:2944-SEEDOC" lastVersionId="21" liveVersionId="21">
                        <p:linkPartInfo id="7" mimeType="text/xml" name="SimpleDocumentContent" size="2940"/>
                    </p:linkInfo>openMapDB</a>
            </em>command,
and the <em>destinationfiledvalue</em> in the defined destination field of the
<em>
                <a href="dsy20886-SEEDOC.html#dsy2944-SEEDOC">
                    <p:linkInfo access="read,fullRead,write,publish,delete" documentName="openMapDB" documentType="SimpleDocument" href="daisy:2944-SEEDOC" lastVersionId="21" liveVersionId="21">
                        <p:linkPartInfo id="7" mimeType="text/xml" name="SimpleDocumentContent" size="2940"/>
                    </p:linkInfo>openMapDB</a>
            </em>command, for example:</p>
        
<pre>writeToMapDB("Maptable1", "EAN4", "ABC");</pre>
        
<p>
            
<em>updateToMapDB</em>(<em>&lt;lookupname&gt;,
&lt;sourcefieldvalue&gt;, &lt;destinationfieldvalue&gt;</em>). Updates the value
of the<em> destination field</em>. It returns the number of updated records:</p>
        
<pre>copy updateToMapDB("Maptable1", "EEAN4", "XYZ") to r%;
traceln("Updated records=" &amp; r%);</pre>
        
<p>
            
<em>deleteFromMapDB</em>(<em>&lt;lookupname&gt;,
&lt;sourcefieldvalue&gt;</em>). Deletes a record and returns the number of
delete records:</p>
        
<pre>if deleteFromMapDB("Maptable1","EAN4")=1 
	traceln("delete ok");
endif</pre>
        
<h11 id="s141">Simple Example</h11>
        
<p>An <em>EAN</em>-type code is mapped to an internal article code.<em>
ArticleCodes</em> is the table name, <em>EAN </em>is the source (search) field
(column), and <em>Internalcode</em> is the destination field (column).</p>
        
<pre>// the article code as 'EAN' type
dim eancode$;

// connect to the data base
connectdb("DATABASE","jdbc:seeburger:jucon://dbports","","","com.seeburger.jucon.locator.DataSourceDriver");

// declare table, source and destination field (column)
openMapDB("MAP", "DATABASE", "ArticleCodes", "EAN", "InternalCode", "");

// the key value to identify the record 
eancode$ = "0815";

// copy the value from the destination field (column) 
copy mapDB("MAP", eancode$) to OUTRECORD:CODE;</pre>
        
</div>
<div class="right">
<a href="dsy21051-SEEDOC.html"><img src="resources/images/big_right.gif"></a>
</div>
</div>
<div id="pageNumber">
<div class="numberAndTitle">
<span class="bottomTitle">Training BIC 6 Basics</span><span class="count">109</span>
</div>
</div>
</div>
</body>
</html>
